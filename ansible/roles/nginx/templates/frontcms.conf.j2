server {
        listen          80;
        server_name     {{ front_cms_domain }};
        root            /srv/www/{{ cms_folder }}/backend;
        index           index.php;

        client_max_body_size 500M;

        location / {
                index index.php index.html index.htm;
                try_files $uri $uri/ @rewrite;
        }

        location ~ \.htaccess {
            deny all;
        }
        
        location ~ \.php$ {
                try_files $uri =404;                
                fastcgi_index index.php;
                fastcgi_pass  127.0.0.1:9000;                
                include       fastcgi_params;
        }

        location @rewrite {
                rewrite ^/tim-kiem(.*)$ /index.php?r=page/render&slug=tim-kiem&$1 last;
                rewrite ^/xem/(.*)/([0-9]+).html(.*)$ /index.php?r=page/render&slug=preview&key=$1&id=$2&data=$3 last;
                rewrite ^/in/(.*)/([0-9]+).html(.*)$ /index.php?r=page/render&slug=post&pslug=$1&id=$2&data=$3 last;
                rewrite ^/tin/(.*)/([0-9]+).html(.*)$ /index.php?r=page/render&slug=post&pslug=$1&id=$2&data=$3 last;
                rewrite ^/chu-de/(.*)/([0-9]+).html(.*)$ /index.php?r=page/render&slug=chu-de&pslug=$1&id=$2&data=$3 last;
                rewrite ^/trang/(.*)$ /index.php?r=page/render&slug=$1 last;
                rewrite ^/(.*)$ /index.php?r=$1 last;
        }

        location ~ /\.ht {
            deny  all;
        }

        location ~ /\.svn {
            deny  all;
        }
}